function loadcustomer(a){var b=(new Date).getTime();$.ajax({url:APIDOMAIN+"index.php?action=customerList&pgno="+a+"&limit=50&timestamp="+b,success:function(b){loadCustomerCallback(b,a)}})}function loadCustomerCallback(a,b){var c=jQuery.parseJSON(a);if(""!=c.results){$("#pgno").val(b);var d=c.total_customers;$("#customerList").text("Customer ("+d+")");var e=c.total_customers,f="";if(0!=d){e==currentPage&&(loadCustomers=!1);for(var g=c.results.length,h=0;h<g;)console.log(c.results),f+=customerList(c.results[h]),h++;pagination(c,b)}else f='<div class="noRecords"><span>Sorry! No Customer Found!</span></div>',loadcustomers=!1;$(".cntctCard").html(f),$(".scntctCard").html(f),$(".pgComm").click(function(){$(".pgComm").removeClass("pgActive"),$(this).addClass("pgActive"),loadcustomer($(this).text()),$("html,body").animate({scrollTop:$(".cstmrCnt").offset().top-100},300)}),paginationPrevNext()}else loadcustomers=!1}function customerList(a){var b="";return $(a).each(function(a,c){b+='<div class="cDtls fLeft" id="customer_'+c.uid+'">',b+='<div class="cList fLeft">',b+='<div class="div15 fLeft txtCenter">'+c.joinDate+"</div>",b+='<div class="div22 fLeft txtCenter">'+c.name+"</div>",b+='<div class="div25 fLeft"><div class="emIcon fLeft">'+c.email+"</div></div>",b+='<div class="div18 fLeft txtCenter"><div class="mbIcon fLeft">'+c.mobile+"</div></div>",b+='<div class="div20 fLeft txtCenter bRnone">'+c.city+" ( "+c.state+" )</div>",b+="</div>",b+="</div>",b+="</div>"}),b}function pagination(a,b){b*=1;var c="",d=a.total_customers,e=Math.ceil(d/50),f=2;if($("#total_pageno").val(e),e>1){if(c+='<div class="fLeft pagination fmOpenR">',c+="<center>",c+='<div class="pPrev poR ripplelink">Previous</div>',e<7+2*f)for(var g=1;g<=e;g++)c+=g==b?'<div class="pgComm poR ripplelink pgActive">'+g+"</div>":'<div class="pgComm poR ripplelink">'+g+"</div>";else if(e>5+2*f)if(b<1+2*f){for(var g=1;g<4+2*f;g++)c+=g==b?'<div class="pgComm poR ripplelink pgActive">'+g+"</div>":'<div class="pgComm poR ripplelink">'+g+"</div>";c+='<div class="pgEmpty"></div>',c+='<div class="pgEmpty"></div>',c+='<div class="pgEmpty"></div>',c+='<div class="pgComm poR ripplelink">'+e+"</div>"}else if(e-2*f>b&&b>2*f){c+='<div class="pgComm poR ripplelink">1</div>',c+='<div class="pgEmpty"></div>',c+='<div class="pgEmpty"></div>',c+='<div class="pgEmpty"></div>';for(var g=b-f;g<=b+f;g++)c+=g==b?'<div class="pgComm poR ripplelink pgActive">'+g+"</div>":'<div class="pgComm poR ripplelink">'+g+"</div>";c+='<div class="pgEmpty"></div>',c+='<div class="pgEmpty"></div>',c+='<div class="pgEmpty"></div>',c+='<div class="pgComm poR ripplelink">'+e+"</div>"}else{c+='<div class="pgComm poR ripplelink">1</div>',c+='<div class="pgEmpty"></div>',c+='<div class="pgEmpty"></div>',c+='<div class="pgEmpty"></div>';for(var g=e-(2+2*f);g<=e;g++)c+=g==b?'<div class="pgComm poR ripplelink pgActive">'+g+"</div>":'<div class="pgComm poR ripplelink">'+g+"</div>"}c+='<div class="pNext poR ripplelink">Next</div>',c+="</center>",c+="</div>"}return c}function paginationPrevNext(){$(".pPrev").bind("click",function(){var a=parseInt($("#pgno").val()),b=a-1;a>1&&($("#pgno").val(b),loadcustomer(pageName.indexOf("customerDtls")!==-1?b:1))}),$(".pNext").bind("click",function(){var a=parseInt($("#pgno").val()),b=a+1;a<parseInt($("#total_pageno").val())&&($("#pgno").val(b),loadcustomer(pageName.indexOf("customerDtls")!==-1?b:1))})}function searchVendor(a,b){if(b||(b=1),""!=a){var c=(new Date).getTime();$.ajax({url:DOMAIN+"apis/index.php?action=customerList&srchTxt="+encodeURIComponent(a)+"&page="+b+"&limit=50&timestamp="+c,success:function(a){searchVendorCallback(a,b)}}),searchScrollValue=a}else $(".cntctCard").removeClass("dn"),$(".scntctCard").html("").addClass("dn")}function searchVendorCallback(res,pgno){var obj=eval("("+res+")");if(""!==obj.results){var total=obj.total_customers;if(0!=total){$(".cntctCard").addClass("dn"),$(".scntctCard").removeClass("dn");for(var len=obj.results.length,i=0,str="";i<len;)str+=customerList(obj.results[i]),i++;var html=pagination(obj,pgno);void 0!==str&&null!==str&&""!==str&&($(".scntctCard").html(str),$(".pgComm").click(function(){$(".pgComm").removeClass("pgActive"),$(this).addClass("pgActive");var a=$("#searchVendor").val();searchVendor(a,$(this).text()),$("#pgno").val($(this).text()),$("html,body").animate({scrollTop:$(".scntctCard").offset().top-100},300)}))}else if(1==pgno){var str='<div class="noResult fLeft fmopenR"><span>Sorry! No Vendors Found!</span></div>';$(".scntctCard").html(str)}}}var uid=customStorage.readFromStorage("userid"),is_vendor=customStorage.readFromStorage("is_vendor"),userName=customStorage.readFromStorage("name");$("#userName").html(userName.split(" ")[0]),$(document).ready(function(){loadcustomer(1)});var loadCustomers=!0,currentPage=1;loadcustomer(1),$(".pPrev").bind("click",function(){var a=parseInt($("#pgno").val()),b=a-1;a>1&&($("#pgno").val(b),loadcustomer(pageName.indexOf("customerDtls")!==-1?b:1))}),$(".pNext").bind("click",function(){var a=parseInt($("#pgno").val()),b=a+1;a<parseInt($("#total_pageno").val())&&($("#pgno").val(b),loadcustomer(pageName.indexOf("customerDtls")!==-1?b:1))});
