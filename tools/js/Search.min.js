function Search(){var a=this;a.path="",a.autoSuggestDivId,a.tfSearchId,a.callBackAutoSuggest,a.appId,a.minimumSearchChar=2,a.scripSearch,a.suggestLen=0,a.suggestRow=-1,a.ltSuggestRow=-1,a.suggestionList,a.resultArray=new Array,a.searchType="location",a.defaultPos=0,a.setData=!1,a.rowLimit=4,this.setAppId=function(b){a.appId=b},this.setMinimumSearchChar=function(b){a.minimumSearchChar=b},this.setPath=function(b){a.path=b},this.setId=function(b,c,d,e){a.autoSuggestDivId=b,a.tfSearchId=c,a.callBackAutoSuggest=d,a.scripSearch=e},this.setSearchResult=function(b){if(a.setData=!0,a.arrayResult)a.lastChar="",a.callBackAutoSuggest(a.suggestionList[b]);else{var c=jQuery.parseJSON(a.suggestionList);a.lastChar="",a.callBackAutoSuggest(c[b])}},this.getKeyVal=function(a){var b;return b=a?a.keyCode:window.event.keyCode},this.highlightSuggest=function(b,c){var d=a.getKeyVal(b);if(38!=d&&40!=d&&13!=d)a.suggestRow=-1,a.ltSuggestRow=-1;else{var e=!1;if(a.arrayResult?e=!0:c.length>0&&(e=!0),e){if(40==d)a.suggestRow>=a.suggestLen&&(a.suggestRow=-1),a.suggestRow++,a.handler(a.suggestRow);else if(38==d)a.suggestRow<=0&&(a.suggestRow=1),a.suggestRow--,a.handler(a.suggestRow);else if(13==d)return a.suggestRow<0&&(a.suggestRow=0),a.setSearchResult(a.suggestRow),!1;return a.ltSuggestRow>-1&&a.suggestResultOut(a.ltSuggestRow),a.suggestResultOver(a.suggestRow),a.ltSuggestRow=a.suggestRow,!1}}return!0},this.handler=function(b){if(a.suggestLen>a.rowLimit)if(b++,a.suggestLen<b)$("#"+a.autoSuggestDivId+" .smallField").scrollTop(0),a.suggestRow=0;else if(b>=a.rowLimit){var c=b-a.rowLimit,d=30*c;$("#"+a.autoSuggestDivId+" .smallField").scrollTop(d)}},a.lastSuggestRow="",this.suggestResultOver=function(b){var c="suggest"+b;$("#"+c).addClass("autoSuggestRowSelect"),a.lastSuggestRow=c},this.suggestResultOut=function(b){""!=a.lastSuggestRow&&$("#"+a.lastSuggestRow).removeClass("autoSuggestRowSelect")},this.reverse=!1,this.setAutoSuggestDivPos=function(){},a.arrayResult=!1,a.lastChar="",this.showHint=function(b,c){if(a.arrayResult)a.highlightSuggest(c,b)&&a.scripSearch(b);else if(a.highlightSuggest(c,b))if(b=b.replace(" ",""),b!=a.lastChar&&""!=b){a.lastChar=b;var d=a.path+global.encodeMsg(b);global.getData(d,a.scripSearch)}else document.getElementById(a.autoSuggestDivId).innerHTML=""},this.searchFocusLost=function(){a.setData||a.setSearchResult(a.defaultPos)},this.arraySuggest=function(b){var c=new Array;if(""!=b){b=b.toLowerCase();for(var d=a.resultArray.length,e=0,f=b.length;e<d;){var g=a.resultArray[e].substring(0,f).toLowerCase();console.log("arraySuggest "+g+" str "+b),g==b&&c.push(e),e++}}return c},this.appendSuggestion=function(a,b,c){var d=c.length,e=0;b=b.toUpperCase();for(var f=b.length,g=new Array;e<d;){for(var h=c[e][a].split(" "),i=h.length,j=0;j<i;){var k=h[j].substring(0,f).toUpperCase();if(b==k){g.push(c[e]);break}j++}e++}return g},this.finalSuggestion=function(a,b){var c=a.length,d=b.length;if(0==c)return 0!=d&&b;if(0==d)return 0!=c&&a;var e=0,f=new Array;for(f=f.concat(a);e<d;){for(var g=0,h=!0;g<c;){if(b[e].c==a[g].c){h=!1;break}g++}h&&f.push(b[e]),e++}return f}}
