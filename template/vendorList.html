<?php include 'vendorHead.html'; ?>
<div class="mainContainer fLeft vListPage">
    <div class="topFixedCont">
        <div class="vndHeader fLeft">
            <div class="wrapperMax">
                <div class="vndLogo fLeft fmOpenR pointer" onclick="window.location.assign(DOMAIN);"><b>IF</b>to<b>SI</b></div>
                <div class="vndInfo fRight fmOpenR">
                    Hi, <span id="userName"></span> |
                    <div class="fRight pointer" onclick="common.doLogout();"><span>Logout</span></div>
                </div>
            </div>
        </div>
    </div>
    <div id='vList' class="vList fLeft">
        <div class="listHeader fLeft fmOpenR">
            <div class="fLeft headName">Vendor Name</div>
            <div class="fLeft headPackage">Package</div>
            <div class="fLeft headAmount">Amount</div>
            <div class="fLeft headExpDate">Expiry Date</div>
            <div class="fLeft headEdit">Activated</div>
        </div>
        <div class="listContainer fLeft fmOpenR">
        <?php
        for($i=0; $i<count($data); $i++)
        {
        ?>
            <div class="listComm fLeft fmOpenR">
                <div class="fLeft vndName">

                    <div class="nameLocatCont fLeft txtOver hedofc" id="cn_14267019859310"><?php echo $data[$i]['orgName'];?> - <?php echo $data[$i]['city'];?></div>
                    <div class="mobileEmailCont fLeft cBlue txtOver">
                        <div class="fLeft">
                            <div class="mbIcon fLeft" id="mo_14267019859310"><?php echo $data[$i]['contact_mobile']?></div>
                            <div class="emIcon fLeft" id="em_14267019859310"><?php echo $data[$i]['email']?></div>
                        </div>
                    </div>
                </div>
                <?php
                    $expd = explode(',',$data[$i]['business_type']);
                    $cost = 0;
                    $arr = array();
                    for($j=0;$j<count($expd);$j++)
                    {
                        if($expd[$j] == 1)
                        {
                            $arr[] = 'Diamonds';
                            $cost += 30000;
                        }
                        if($expd[$j] == 2)
                        {
                            $arr[] = 'Jewellery';
                            $cost += 15000;
                        }
                        if($expd[$j] == 3)
                        {
                            $arr[] = 'Bullion';
                            $cost += 15000;
                        }
                    }
                    $package = implode(',',$arr);
                ?>
                <div class="fLeft vndPackage"><?php echo $package?></div>
                <div class="fLeft vndAmount"><?php echo $cost?></div>
                <div class="fLeft vndExpDate">NA</div>
                <div class="fLeft vndEdit">
                    <div class="toggle-button toggle-button <?=($data[$i]['is_active']==0) ? 'toggle-button-selected' : '';?>" onclick="changeStatus(<?=$data[$i]['vendor_id'];?>,this)">
                        <span class="fActive">Yes</span>
                        <button class="button"></button>
                        <span class="fDactive">No</span>
                    </div>
                </div>
            </div>
        <?php
        }
        ?>
        </div>
    </div>
</div>

<script>

    $(document).ready( function(){
        $('.toggle-button').each(function(){
            if($(this).hasClass('cyes'))
            {
                $(this).addClass('toggle-button-selected');
            }
        });
    });
    $(document).on('click', '.toggle-button', function() {
        $(this).toggleClass('toggle-button-selected');
    });



    function changeStatus(uid,obj) {
        var st = 0;
        setTimeout(function() {
            var pLeft = $(obj).find(".button").position().left;
            if (pLeft === 0) {
                st = 1;
            } else {
                st = 0;
            }
            var URL = DOMAIN+ "index.php?action=ajx&case=updateStatus&uid=" + uid +"&af="+st;
            $.ajax({
                url: URL,
                type: 'POST',
                success: function(res) {
                    if(uid !== null)
                    {
                        var params = 'action=Vpactive&vid='+uid+'&af='+st;
                        var URL = APIDOMAIN + "index.php";

                        $.getJSON(URL, params, function(data) {
                                            if(data !== null && data !== undefined && data !== '' && data !== 'null' && data !== 'undefined' && typeof data !== 'undefined')
                                            {
                                                    if(data.error !== '' && data.error !== null && data.error !== undefined && data.error !== 'undefined' && typeof data.error !== 'undefined' && data.error.Code == 0)
                                                    {
                                                             customStorage.toast(1, 'Vendor status is changed');
                                                    }
                                            }
                        });
                    }
             }
            });
        }, 350);
    }

</script>
<script type="text/javascript" src='tools/js/cms/lib/jquery.toast.min.js'></script>
</body>
</html>
